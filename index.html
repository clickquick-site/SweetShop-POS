<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUPER_POS - نظام الكاشير</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #2c3e50; --secondary: #3498db; --success: #27ae60; --danger: #e74c3c; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: var(--bg); display: flex; height: 100vh; }
        
        /* القائمة الجانبية */
        .sidebar { width: 250px; background: var(--primary); color: white; display: flex; flex-direction: column; padding: 20px 0; }
        .sidebar-header { text-align: center; padding: 0 20px 20px; border-bottom: 1px solid #3e5871; font-weight: bold; font-size: 1.2rem; }
        .nav-link { padding: 15px 25px; color: #bdc3c7; text-decoration: none; display: flex; align-items: center; transition: 0.3s; cursor: pointer; }
        .nav-link:hover, .nav-link.active { background: var(--secondary); color: white; }
        .nav-link i { margin-left: 15px; width: 20px; }

        /* المحتوى الرئيسي */
        .main-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .header { background: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .search-box { width: 50%; position: relative; }
        .search-box input { width: 100%; padding: 10px 40px 10px 10px; border-radius: 8px; border: 1px solid #ddd; outline: none; }
        .search-box i { position: absolute; right: 15px; top: 12px; color: #999; }

        /* منطقة العمل والسلة */
        .content-area { display: flex; flex: 1; padding: 20px; gap: 20px; overflow: hidden; }
        .pos-section { flex: 2; background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); overflow-y: auto; }
        .cart-section { flex: 1; background: #fff; border-radius: 12px; display: flex; flex-direction: column; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        
        /* تصميم السلة */
        .cart-header { background: #3e5871; color: white; padding: 15px; border-radius: 12px 12px 0 0; text-align: center; font-weight: bold; }
        .cart-items { flex: 1; padding: 10px; overflow-y: auto; }
        .cart-footer { padding: 20px; border-top: 1px solid #eee; }
        .total-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 1.1rem; }
        .grand-total { font-size: 1.5rem; font-weight: bold; color: var(--danger); border-top: 2px dashed #eee; padding-top: 10px; }
        
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        .btn-pay { background: var(--success); color: white; font-size: 1.1rem; }
        .btn-pay:hover { opacity: 0.9; }

        /* البطاقات البرمجية */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; }
        .product-card { background: #fdfdfd; border: 1px solid #eee; border-radius: 10px; padding: 15px; text-align: center; transition: 0.2s; cursor: pointer; }
        .product-card:hover { border-color: var(--secondary); transform: translateY(-3px); }
        .product-card img { width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px; }
        .product-card .price { color: var(--success); font-weight: bold; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header">SUPER_POS</div>
        <div class="nav-link active"><i class="fas fa-shopping-cart"></i>نقطة البيع</div>
        <div class="nav-link"><i class="fas fa-box"></i>المنتجات</div>
        <div class="nav-link"><i class="fas fa-chart-line"></i>التقارير</div>
        <div class="nav-link"><i class="fas fa-users"></i>المستخدمين</div>
        <div class="nav-link" style="margin-top: auto; color: #e74c3c;"><i class="fas fa-sign-out-alt"></i>خروج</div>
    </div>

    <div class="main-content">
        <div class="header">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="barcodeScanner" placeholder="بحث باسم المنتج أو الباركود..." autofocus>
            </div>
            <div class="user-info">مرحباً، <strong>أدمن المحل</strong> <i class="fas fa-user-circle"></i></div>
        </div>

        <div class="content-area">
            <div class="pos-section">
                <div class="product-grid" id="productGrid">
                    </div>
            </div>

            <div class="cart-section">
                <div class="cart-header">سلة المشتريات</div>
                <div class="cart-items" id="cartItems">
                    </div>
                <div class="cart-footer">
                    <div class="total-row"><span>المجموع:</span> <span id="subTotal">0.00</span></div>
                    <div class="total-row grand-total"><span>الصافي:</span> <span id="grandTotal">0.00</span> دج</div>
                    <button class="btn btn-pay" onclick="window.print()"><i class="fas fa-print"></i> دفع وطباعة</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let cart = [];

        // تحميل المنتجات وعرضها كبطاقات عند فتح الصفحة
        fetch('products.json')
            .then(res => res.json())
            .then(products => {
                const grid = document.getElementById('productGrid');
                products.forEach(p => {
                    grid.innerHTML += `
                        <div class="product-card" onclick="addToCartById('${p.id}')">
                            <i class="fas fa-cookie-bite fa-3x" style="color:#ddd"></i>
                            <h4>${p.name_ar}</h4>
                            <div class="price">${p.sell_price} دج</div>
                            <small>مخزون: ${p.stock}</small>
                        </div>
                    `;
                });

                // تفعيل البحث والباركود
                document.getElementById('barcodeScanner').addEventListener('change', (e) => {
                    const product = products.find(p => p.id === e.target.value);
                    if(product) addToCart(product);
                    e.target.value = '';
                });
            });

        function addToCartById(id) {
            fetch('products.json').then(res => res.json()).then(products => {
                const product = products.find(p => p.id === id);
                if(product) addToCart(product);
            });
        }

        function addToCart(product) {
            const item = cart.find(i => i.id === product.id);
            if(item) { item.qty++; } else { cart.push({...product, qty: 1}); }
            renderCart();
        }

        function renderCart() {
            const container = document.getElementById('cartItems');
            container.innerHTML = '';
            let total = 0;
            cart.forEach(item => {
                total += item.sell_price * item.qty;
                container.innerHTML += `
                    <div style="display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #eee;">
                        <div><strong>${item.name_ar}</strong> <br> <small>${item.qty} x ${item.sell_price}</small></div>
                        <div style="font-weight:bold">${item.qty * item.sell_price}</div>
                    </div>
                `;
            });
            document.getElementById('subTotal').innerText = total.toFixed(2);
            document.getElementById('grandTotal').innerText = total.toFixed(2);
        }
    </script>
</body>
</html>
